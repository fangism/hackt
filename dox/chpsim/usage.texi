@c "usage.texi"
@c $Id: usage.texi,v 1.1.2.1 2007/07/30 22:50:01 fang Exp $

@node Usage
@chapter Usage
@cindex usage
@cindex options
@cindex command-line
@cindex flags

This chapter describes @command{chpsim}'s command-line options.  

Usage:
@samp{hacchpsim [@var{options}] @var{obj-file}}

To pass a script to @command{hacchpsim}, use shell redirection or pipes.
For example,
@example
$ @kbd{cat test.chpsimrc | hacchpsim -b test.haco}
@end example

or

@example
$ @kbd{hacchpsim -b test.haco < test.chpsimrc}
@end example

@menu
* Option Summary:: Description of command-line arguments.
* General Flags:: Flag descriptions.
* Graph Generation:: Flag descriptions.
@end menu

@c ****************************************************************************
@node Option Summary
@section Option Summary

@c These might be better managed in the source file for ease of maintainence.
For options that take an argument, the space between the flag
and the argument is optional.  

@defopt @r{(none)}
With no arguments, just print a list of all command-line options, 
much like what is summarized below.  
@end defopt

@defopt	-b
Batch mode, non-interactive, promptless.  
This is useful for running scripts or piping in commands 
while suppressing prompts.  
This mode also turns off tab-completion in the interpreter.  
The opposing option is @option{-i}.
@b{Note:} executables linked against libeditline may @emph{require} 
this option for processing scripts due to a mishandling of EOF.  
@end defopt

@defopt -d @var{checkpoint}
Produce a textual dump of a checkpoint binary.  
Exits without running the simulator.  
@end defopt

@defopt -f @var{flag}
@xref{General Flags}.
@end defopt

@defopt -h
Help.  Print list of all interpreter commands and exit.  
@end defopt

@defopt -i
Interactive, prompting.  This is the default mode.
The opposing option is @option{-b}.  
@end defopt

@defopt -I path @r{(repeatable)}
@anchor{option-I}
Append @var{path} to the list of paths to search for sourcing other 
command scripts in the interpreter.  
@end defopt

@defopt -L path @r{(repeatable)}
@anchor{option-L}
Append @var{path} to the list of paths to search for opening shared library
plug-ins (modules).  
The equivalent command in the interpreter is
@ref{command-dladdpath,, @command{dladdpath}}.
For more on building and loading shared-libraries, @xref{Extending simulation}.
@end defopt

@defopt -l lib @r{(repeatable)}
@anchor{option-l}
Load the @var{lib} shared library module for registering user-defined
run-time functions.  
@var{lib} should be named @emph{without} its file extension, 
for the sake of portability.  
@c @var{lib}'s name should match that of the built library's base.
For example, @file{libcrunch.la} should be referenced as @samp{libcrunch}, 
and @file{chewy.so} should be referenced as @samp{chewy}.
The equivalent command in the interpreter is
@ref{command-dlopen,, @command{dlopen}}.
@end defopt

@c ****************************************************************************
@node General Flags
@section General Flags
@cindex flags, general

For lack of better organization, many general purpose flags
are folded into the @option{-f} option.
Unless otherwise noted, 
all @option{-f} options have a @option{no-} prefixed counterpart, 
so @option{-f no-disassemble} is the intuitive negation
of @option{-f disassemble}.  
Later options always override earlier options.  

@defopt {-f check-structure}
Run additional internal graph (nodes and edges) consistency checks.
Enabled by default.
@end defopt

@defopt {-f default}
Resets to default flags.  Has no negation.  
@end defopt

@defopt {-f dump-graph-alloc}
Diagnostic tool.  
Produce a textual dump of expression allocation after the internal 
whole-program graph has been constructed.  
@end defopt

@defopt {-f dump-dot-struct}
@cindex dot
@cindex event-graph
Produce a textual netlist of the whole-program event graph in 
@command{dot} format @footnote{@command{dot} 
is the name of a program (and its input language)
that is part of AT&T's GraphViz package (open-source).}.
A list of options that tune this output can be found in
@ref{Graph Generation}.
@end defopt

@defopt {-f run}
Actually run the simulator's interpreter.  Enabled by default.
@samp{-f no-run} is explicitly needed when all that is desired
are diagnostic dumps.  
@end defopt

@c ****************************************************************************
@node Graph Generation
@section Graph Generation
@cindex flags, graph

The following flags are relevant only with @option{-f dump-dot-struct}.
All of these options are also negatable with @option{no-} prefixed.  
Don't forget to pass @option{-f no-run} when not intending to run the 
interpreter.  

@defopt {-f cluster-processes}
Wrap process subgraphs into clusters, 
which are enveloped in rectangular outlines.  Default off.  
@end defopt

@defopt {-f show-channels}
Label channel edges with their channel names.  Default off.  
@end defopt

@defopt {-f show-delays}
Annotate event nodes with their delay values.  Default off.  
@end defopt

@defopt {-f show-event-index}
Annotate event nodes with their globally allocated indices.  Default off.  
@end defopt

@defopt {-f show-instances}
Also show allocated instances as nodes.  Default off.  
@end defopt


